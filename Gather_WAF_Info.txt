resources
| where type =~ 'Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies' or type =~ 'microsoft.network/frontdoorwebapplicationfirewallpolicies' or type =~ 'microsoft.cdn/cdnwebapplicationfirewallpolicies' 
|project subscriptionId, name, properties['policySettings']['mode'], properties['policySettings']['requestBodyCheck'], properties['managedRules']['managedRuleSets'][0]['ruleSetType'], properties['managedRules']['managedRuleSets'][0]['ruleSetVersion'], properties['managedRules']['managedRuleSets'][0]['ruleGroupOverrides'], properties['customRules']